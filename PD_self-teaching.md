# Medical Ultrasound - Power Doppler (PD)

## ä¸€ã€å†å²èƒŒæ™¯ç®€è¿°

å¤šæ™®å‹’è¶…å£°æŠ€æœ¯æœ€æ—©ç”±Shigeo Satomura[æ—¥æœ¬]åœ¨1950å¹´ä»£å¼•å…¥åŒ»å­¦ï¼Œç”¨äºæ£€æµ‹å¿ƒè„è¡€æµã€‚éšåå‘å±•å‡ºå½©è‰²å¤šæ™®å‹’ï¼ˆColor Dopplerï¼‰å’ŒåŠŸç‡å¤šæ™®å‹’ï¼ˆPower Doppler, PDï¼‰ç­‰å¤šç§å½¢å¼ã€‚PD äº1990å¹´ä»£åˆè¢«æå‡ºï¼Œæ˜¯å½©è‰²å¤šæ™®å‹’çš„ä¸€ç§æ”¹è¿›å½¢å¼ï¼Œä¸“æ³¨äºè¡€æµä¿¡å·å¼ºåº¦çš„å¯è§†åŒ–ã€‚

- **1950s**: æ—¥æœ¬å­¦è€…é‡Œæ‘èŒ‚å¤«(Shigeo Satomura)é¦–æ¬¡å°†å¤šæ™®å‹’æ•ˆåº”åº”ç”¨äºç”Ÿç‰©åŒ»å­¦æ£€æµ‹ï¼Œå¼€å‘å‡ºè¿ç»­æ³¢å¤šæ™®å‹’ç³»ç»Ÿç”¨äºå¤–å‘¨è¡€ç®¡ç ”ç©¶
- **1959**: Satomuraå‘è¡¨é¦–ç¯‡å¤šæ™®å‹’è¶…å£°å¿ƒåŠ¨å›¾è®ºæ–‡ï¼Œå¼€åˆ›è¡€æµåŠ¨åŠ›å­¦æ— åˆ›è¯„ä¼°å…ˆæ²³
- **1980s**: å½©è‰²å¤šæ™®å‹’(Color Doppler)æŠ€æœ¯å®ç°å•†ä¸šåŒ–ï¼Œç”±Alokaå…¬å¸ç‡å…ˆæ¨å‡º
- **1994**: Rubinç­‰äººåœ¨ã€ŠRadiologyã€‹æ­£å¼æå‡ºPower Doppleræ¦‚å¿µ **(åŸç§°Color Doppler Energy)**
- **1995**: è¥¿é—¨å­æ¨å‡ºé¦–å°é›†æˆPower Dopplerçš„ä¸´åºŠè®¾å¤‡ï¼ˆAcuson 128XP/10ï¼‰

| æ—¶æœŸ         | æŠ€æœ¯çªç ´                  | å±€é™æ€§è§£å†³             |
|--------------|--------------------------|--------------------------|
| 1950s        | è¿ç»­æ³¢å¤šæ™®å‹’              | åªèƒ½æ£€æµ‹é«˜é€Ÿè¡€æµ         |
| 1982         | è„‰å†²æ³¢å¤šæ™®å‹’              | å®ç°æ·±åº¦åˆ†è¾¨ä½†æ˜“æ··å      |
| 1985         | å½©è‰²å¤šæ™®å‹’                | è§’åº¦ä¾èµ–/ä½é€Ÿè¡€æµä¸æ•æ„Ÿ  |
| **1994**     | åŠŸç‡å¤šæ™®å‹’ **(PD)**       | è§£å†³ä¸Šè¿°æ‰€æœ‰é—®é¢˜         |

---

## äºŒã€åŠ¨æœºä¸ç‰¹ç‚¹ï¼ˆä¸ºä»€ä¹ˆä½¿ç”¨ Power Dopplerï¼‰

- **ä½é€Ÿåº¦åŒºè¡¨ç°æ›´ä½³ï¼š** ç›¸è¾ƒå½©è‰²å¤šæ™®å‹’å¯¹é«˜é€Ÿæµæ›´æ•æ„Ÿï¼ŒPD å¯¹ä½é€Ÿå¾®è¡€æµæ›´å¯é ï¼Œç‰¹åˆ«é€‚ç”¨äºå°è¡€ç®¡å’Œä½é€Ÿè¡€æµæ£€æµ‹ï¼ˆå¦‚ç”²çŠ¶è…ºã€è‚¿ç˜¤æ–°ç”Ÿè¡€ç®¡ç­‰ï¼‰ã€‚
- **è§’åº¦æ— å…³æ€§ï¼š** ä¸ä¾èµ–å£°æŸä¸è¡€æµæ–¹å‘ä¹‹é—´çš„å¤¹è§’ã€‚

---

## ä¸‰ã€åŸç†è§£æï¼ˆé‡ç‚¹ï¼‰

Power Doppler å›¾åƒæ ¸å¿ƒæ˜¯é€šè¿‡å¯¹ slow-time åºåˆ—è¿›è¡Œç»Ÿè®¡ï¼Œä¼°ç®—æ¯ä¸ªåƒç´ ç‚¹çš„**è¡€æµæ•£å°„èƒ½é‡**ï¼Œè€Œéå…¶é€Ÿåº¦æˆ–é¢‘ç‡ã€‚

### æµç¨‹å›¾ï¼š

```mermaid
graph TD
    A[RFæ•°æ®é‡‡é›†,æ··é¢‘ä¸‹å˜é¢‘] --> B[Beamforming]
    B --> C[å¢™æ»¤æ³¢å™¨ï¼ˆWall Filterï¼‰]
    C --> D[ä¿¡å·èƒ½é‡è®¡ç®—ï¼ˆPowerï¼‰]
    D --> E[å›¾åƒæ˜ å°„ï¼Œé¢œè‰²ç¼–ç ï¼Œæ˜¾ç¤º]
```



### 1. ä¿¡å·é‡‡é›†ä¸å‰å¤„ç†ï¼š 
   - è¶…å£°æ¢å¤´å‘å‡ºè¶…å£°æ³¢ï¼Œé‡åˆ°è¡€æ¶²ä¸­çš„**çº¢ç»†èƒ**è¢«æ•£å°„ï¼Œæ¥æ”¶åˆ°**å°„é¢‘ï¼ˆRFï¼‰ä¿¡å·**ã€‚
   - å¯¹åŒä¸€ä½ç½®è¿›è¡Œå¤šæ¬¡é‡å¤é‡‡æ ·ï¼Œå½¢æˆ slow-time æ—¶é—´åºåˆ—ï¼š

     <p align="center">
     <img src="https://github.com/user-attachments/assets/a6e85f86-e79c-4e9f-80d6-aa55fa7671c0" alt="ULM Example" width="400">
     </p>
   
   - IQ è§£è°ƒ (Demodulation)
   - æ³¢æŸåˆæˆ (Beamforming)
     å¾—åˆ°ä¿¡å·ç»´åº¦ä¸º $(x, y, n)$ï¼Œå…¶ä¸­ $n = [1, \dots, N]$ æ˜¯ slow-time ç»´åº¦

     
### 2. å¢™æ»¤æ³¢ (Wall Filter)ï¼š
   ä½¿ç”¨é«˜é€šæ»¤æ³¢å™¨å»é™¤ä½é¢‘çš„ç»„ç»‡è¿åŠ¨å¹²æ‰°ï¼ˆå¦‚å¿ƒè·³ã€å‘¼å¸è¿åŠ¨ï¼‰ï¼Œä¿ç•™çœŸæ­£ç”±è¡€æµå¼•èµ·çš„é¢‘ç‡åˆ†é‡ã€‚

| åˆ†é‡       | é¢‘ç‡ç‰¹æ€§        | æŒ¯å¹…å¼ºåº¦        |
| -------- | ----------- | ----------- |
| **ç»„ç»‡è¿åŠ¨** | ä½é¢‘ï¼ˆ0-30 Hzï¼‰ | **å¼ºï¼Œä½†ç¼“æ…¢å˜åŒ–** |
| **è¡€æµä¿¡å·** | é«˜é¢‘ï¼ˆ>50 Hzï¼‰  | å¼±ï¼Œä½†å¿«é€Ÿæ³¢åŠ¨     |

**ğŸ¯ ç›®æ ‡ï¼š**
* **æŠ‘åˆ¶ç»„ç»‡åˆ†é‡ï¼ˆä½é¢‘ã€ä½å˜åŒ–ï¼‰**
* **ä¿ç•™è¡€æµåˆ†é‡ï¼ˆé«˜é¢‘ã€å¿«é€Ÿæ³¢åŠ¨ï¼‰**

#### ğŸš§ å¸¸ç”¨æ–¹æ³•ï¼š

| æ–¹æ³•    | å»ç»„ç»‡æ•ˆæœ  | ä¿è¡€æµèƒ½åŠ› | è®¡ç®—é‡   | å®æ—¶æ€§ |
| ----- | ------ | ----- | ----- | --- |
| FIRé«˜é€š | ä¸­      | ä¸­     | ä½     | é«˜   |
| Poly  | ä¸­é«˜     | é«˜     | ä¸­     | ä¸­   |
| DCT   | é«˜      | ä¸­é«˜    | ä¸­     | ä¸­   |
| SVD   | **æœ€é«˜** | **é«˜** | **é«˜** | ä½   |


* SVD æ˜¯ç›®å‰ç ”ç©¶æœ€æ´»è·ƒçš„æ–¹æ³•ä¹‹ä¸€ï¼Œä½†è®¡ç®—è´Ÿæ‹…å¤§ã€‚
* ä¸´åºŠè®¾å¤‡å¤šæ•°é‡‡ç”¨ä¼˜åŒ–è¿‡çš„ FIR é«˜é€šæ»¤æ³¢æˆ– Poly æ»¤æ³¢ã€‚
  
1. **é«˜é€šæ»¤æ³¢å™¨ï¼ˆç»å…¸ Wall Filterï¼‰**

   * æœ¬è´¨æ˜¯æ²¿ slow-time ç»´åº¦æ–½åŠ æ—¶é—´åºåˆ—çš„é«˜é€šæ»¤æ³¢å™¨ã€‚
   * å¯ä¸º FIR/IIR æ»¤æ³¢å™¨ï¼Œæˆ–ç§»åŠ¨å¹³å‡å·®åˆ†å‹æ»¤æ³¢å™¨ã€‚

2. **æ­£äº¤å¤šé¡¹å¼å›å½’æ³•ï¼ˆPolyï¼‰**

   * ä½¿ç”¨ Legendre å¤šé¡¹å¼å¯¹ slow-time æ›²çº¿å»ºæ¨¡ï¼Œå»é™¤ä½é˜¶æˆåˆ†ï¼ˆå³â€œå¹³æ»‘â€è¶‹åŠ¿ï¼‰ï¼Œç•™ä¸‹é«˜é¢‘åˆ†é‡ã€‚
     
     Least-squares ($\lambda^\textrm{th}$ degree) polynomial regression - Orthogonal Legendre polynomials are used. The fitting polynomial is removed from the original I/Q or RF data to keep the high-frequency components. $\lambda$, with $\lambda \geq 0$, represents the degree of the polynomials. The (slow-time) mean values are removed if $\lambda = 0$ (the polynomials are reduced to constants).
  
3. **ç¦»æ•£ä½™å¼¦å˜æ¢ï¼ˆDCTï¼‰**

   * DCT åœ¨ slow-time ä¸Šå°†ä¿¡å·åˆ†è§£ä¸ºé¢‘ç‡æˆåˆ†ï¼Œå»é™¤å‰ n é¡¹ï¼ˆä½é¢‘ç»„ç»‡åˆ†é‡ï¼‰ï¼Œå†åå˜æ¢ã€‚
     
     Truncated discrete cosine transform - Discrete cosine transforms (DCT) and inverse DCT are performed along the slow-time dimension. The signals are filtered by withdrawing the first $\lambda (\geq = 1)$ components, i.e. those corresponding to the $\lambda$ lowest frequencies (with respect to slow-time).
     
4. **å¥‡å¼‚å€¼åˆ†è§£ï¼ˆSVDï¼‰**

   * å°† slow-time ä¿¡å·çŸ©é˜µæŒ‰å¸§å †å æˆäºŒç»´çŸ©é˜µã€‚
   * ç»„ç»‡åˆ†é‡é€šå¸¸ä¸»å¯¼å‰å‡ ä¸ªå¥‡å¼‚å‘é‡ï¼Œå¯¹åº”æœ€å¤§å¥‡å¼‚å€¼ã€‚
   * ä¿ç•™åé¢çš„å°å¥‡å¼‚åˆ†é‡ä»¥æå–è¡€æµä¿¡å·ã€‚
     
     Truncated singular value decomposition - An SVD is carried out after a column arrangement of the slow-time dimension. The signals are filtered by withdrawing the top $\lambda$ singular vectors, i.e. those corresponding to the $\lambda$ greatest singular values.

 

### 3. **ä¿¡å·èƒ½é‡è®¡ç®—ï¼ˆPower Calculationï¼‰**
å°†æ¯ä¸ªåƒç´ ä½ç½® $(x, y)$ å¤„çš„ slow-time ä¿¡å·ç»„åˆæˆä¸€ç»„ï¼Œç§°ä¸ºä¸€ä¸ª ensemble, $[s_1, s_2, s_3, ..., s_N]$, ç”¨äºè®¡ç®—ç»Ÿè®¡ç‰¹å¾ï¼ˆåŠŸç‡ã€æ–¹å·®ç­‰ï¼‰

#### âœ… æ–¹æ³•ä¸€ï¼šæ—¶åŸŸèƒ½é‡ä¼°è®¡ï¼ˆå¸¸ç”¨ï¼‰

* ç›´æ¥å¯¹ IQ ä¿¡å·æ¨¡å€¼å¹³æ–¹åæ±‚å’Œï¼š

$$
P(x, y) = \sum_{n=1}^{N} |s_n(x, y)|^2 
$$

* **ä¼˜ç‚¹ï¼š** ç®€å•ã€é«˜æ•ˆã€é€‚åˆå®æ—¶æˆåƒã€‚
* **è§£é‡Šï¼š** è¶Šå¤šè¡€ç»†èƒé€šè¿‡ï¼Œå¯¹åº”ä¿¡å·è¶Šå¼ºï¼ŒåŠŸç‡è¶Šå¤§ â†’ å›¾åƒè¶Šäº®ã€‚

#### âœ… æ–¹æ³•äºŒï¼šé¢‘åŸŸåŠŸç‡è°±åˆ†æï¼ˆå¯é€‰ï¼‰

* å¯¹æ¯ç»„ ensemble æ‰§è¡Œå¿«é€Ÿå‚…é‡Œå¶å˜æ¢ (FFT)ï¼Œå¾—åˆ°é¢‘è°±ï¼š

$$
S(f; x, y) = \text{FFT}[s_n(x, y)]
$$

* å–æ¨¡å¹³æ–¹ï¼Œåœ¨é¢‘åŸŸç§¯åˆ†ï¼š

$$
P(x, y) = \int |S(f; x, y)|^2 df
$$

* **ä¼˜ç‚¹ï¼š** é€‚åˆåå¤„ç†æˆ–ç ”ç©¶çº§åº”ç”¨ï¼Œèƒ½åˆ†ç¦»å™ªå£°é¢‘æ®µã€‚
* **ç¼ºç‚¹ï¼š** å®æ—¶è®¡ç®—è´Ÿæ‹…è¾ƒé‡ã€‚

#### ğŸ“Œ å¯¹æ¯”æ€»ç»“ï¼š

| æ–¹æ³•  | é€Ÿåº¦ | å®æ—¶æ€§ | ç²¾åº¦ | åº”ç”¨åœºæ™¯     |
| --- | -- | --- | -- | -------- |
| æ—¶åŸŸæ³• | **é«˜**  | **ä¼˜**   | ä¸­  | ä¸´åºŠå®æ—¶æˆåƒ   |
| é¢‘åŸŸæ³• | ä¸­ä½ | å·®   | **é«˜**  | ç ”ç©¶/å¤æ‚åˆ†æç”¨ |

---
